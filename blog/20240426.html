<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Independence and Uncorrelated Normal Random Variables | Karahan Sarıtaş</title> <meta name="author" content="Karahan Sarıtaş"/> <meta name="description" content="<A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/ship.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://karahans.github.io/blog/20240426"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://karahans.github.io/"><span class="font-weight-bold">Karahan</span> Sarıtaş</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/">resume</a> </li> <li class="nav-item "> <a class="nav-link" href="/archive/">archive</a> </li> <div class="toggle-container"> <a id="light-toggle"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </a> </div> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Independence and Uncorrelated Normal Random Variables</h1> <p class="post-description"></p> </header> <article> <h3 id="table-of-contents">Table of Contents</h3> <ul> <li><a href="#introduction">Introduction</a></li> <li><a href="#definitions">Definitions</a></li> <li><a href="#correlation-and-independence">Correlation and Independence</a></li> <li><a href="#gaussian-distribution">Gaussian Distribution</a></li> <li><a href="#uncorrelated-normal-random-variables">Uncorrelated Normal Random Variables</a></li> </ul> <h2 id="introduction">Introduction</h2> <p>While I was studying for my Probabilistic Machine Learning class, I came across this interesting <a href="http://probability.ca/jeff/teaching/uncornor.html" target="_blank" rel="noopener noreferrer">post</a> about a question asked in the Comprehensive Examinations for the PhD in Statistics at Toronto University. The question is about the two normal random variables that are uncorrelated to each other, that is, \(\mathrm{Cov}{[X, Y]} = 0\). We are simply asked whether these variables are necessarily independent or not. This question made me realize an important distinction between individually (but not jointly) normally distributed random variables and jointly normally distributed random variables. Well, before we answer this question, let’s start with the essentials.</p> <h2 id="definitions">Definitions</h2> <p>Assuming we are all familiar with the concepts listed below, let’s go through the definitions once more to have a concrete understanding of what we are dealing with.</p> <ul> <li> <p><strong>Expectation</strong>: The expectation of a random variable \(X\) is defined as \(\mathbb{E}{[X]} = \int_{-\infty}^{\infty} x f_X(x) dx\), where \(f_X(x)\) is the probability density function of \(X\). Similarly, for a discrete random variable \(X\), the expectation is defined as \(\mathbb{E}{[X]} = \sum_{x} x P(X = x)\). We will be using the definition expectation to define covariance in the next point.</p> </li> <li> <p><strong>Variance</strong>: The variance of a random variable \(X\) is defined as \(\sigma_X^2 = \mathbb{E}{[(X - \mathbb{E}{[X]})^2]}\). Variance is used to measure the spread of the data points around the mean.</p> </li> <li> <p><strong>Covariance</strong>: The covariance of two random variables \(X\) and \(Y\) is defined as \(\mathrm{Cov}{[X, Y]} = \mathbb{E}{[(X - \mathbb{E}{[X]})(Y - \mathbb{E}{[Y]})]}\). Covariance is used as a measure to estimate how change in one variable affects the change in another variable.</p> </li> <li> <p><strong>Correlation</strong>: The correlation of two random variables \(X\) and \(Y\) is defined as \(\rho_{X, Y} = \frac{\mathrm{Cov}{[X, Y]}}{\sigma_X \sigma_Y}\), where \(\sigma_X\) and \(\sigma_Y\) are the standard deviations of \(X\) and \(Y\) respectively. Correlation is used to measure the strength and direction of a linear relationship between two variables. Correlation can be thought of as a normalized version of covariance. Covariance has a unit of \(X \times Y\), whereas correlation is a unitless quantity.</p> </li> </ul> <blockquote> <p>In statistics, correlation refers to a <em>linear</em> relationship between the variables.</p> </blockquote> <ul> <li> <strong>Independence</strong>: Two random variables \(X\) and \(Y\) are said to be independent if \(P(X = x, Y = y) = P(X = x) P(Y = y)\) for all \(x\) and \(y\). In the continuous case, probability measure is replaced with probability density.</li> </ul> <h2 id="correlation-and-independence">Correlation and Independence</h2> <p>First of all, let’s establish the relationship between independence and correlation. If two random variables are independent, then they are uncorrelated - let’s prove it first for the continuous case (proof is exactly the same for the discrete case with some minor changes).:</p> <p>If \(X\) and \(Y\) are independent continuous random variables, then \(f(X = x, Y = y) = f(X = x) f(Y = y)\) by definition. \(\mathbb{E}{[X, Y]}\) can be simplified as follows:</p> \[\begin{aligned} \mathbb{E}{[X, Y]} &amp;= \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} x y f_{X, Y}(x, y) dx dy \\ &amp;= \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} x y f_X(x) f_Y(y) dx dy \\ &amp;= \int_{-\infty}^{\infty} x f_X(x) dx \int_{-\infty}^{\infty} y f_Y(y) dy \\ &amp;= \mathbb{E}{[X]} \mathbb{E}{[Y]} \end{aligned}\] <p>Recall the definition of covariance, \(\mathrm{Cov}{[X, Y]} = \mathbb{E}{[X, Y]} - \mathbb{E}{[X]} \mathbb{E}{[Y]}\). If \(X\) and \(Y\) are independent, then \(\mathrm{Cov}{[X, Y]} = 0\). Great! Now comes an important question: if \(X\) and \(Y\) are uncorrelated, are they necessarily independent? The answer is no. We can disprove it by providing a counterexample. Let’s consider the following example:</p> <p>Let’s say we have a random variable \(X\) with a symmetric probability density, that is, \(p(x) = p(-x)\). Also assume that there is another random variable \(Y = f(X)\) such that \(f\) is an even function, that is, \(f(x) = f(-x)\). Now my claim is that these guys are uncorrelated but not independent. Let’s prove it:</p> <p>Since the random variable \(X\) has a symmetric probability density, we can say that \(\mathbb{E}{[X]} = 0\) (negative and positive values will cancel out each other). Let’s calculate \(\mathbb{E}{[XY]}\):</p> \[\begin{aligned} \mathbb{E}{[XY]} &amp;= \mathbb{E}{[X f(X)]} \\ &amp;= \int_{-\infty}^{\infty} x f(x) p(x) dx \\ &amp;= \int_{-\infty}^{0} x f(x) p(x) dx + \int_{0}^{\infty} x f(x) p(x) dx \\ &amp;= \underbrace {\int_{-\infty}^{0} x f(-x) p(-x) dx}_\textrm{let $u=-x$, then $du = -dx$} + \int_{0}^{\infty} x f(x) p(x) dx \;\;\;\; \text{(using symmetry)} \\ &amp;= {\int_{\infty}^{0} -u f(u) p(u) - du} + \int_{0}^{\infty} x f(x) p(x) dx \\ &amp;= {\int_{\infty}^{0} u f(u) p(u) du} + \int_{0}^{\infty} x f(x) p(x) dx \\ &amp;= -{\int_{0}^{\infty} x f(x) p(x) dx} + \int_{0}^{\infty} x f(x) p(x) dx \\ &amp;= 0 \\ \end{aligned}\] <p>We have shown that \(\mathbb{E}{[XY]} = 0\), and we know that \(\mathbb{E}{[X]} = 0\), as a result \(\mathrm{Cov}{[X, Y]} = \mathbb{E}{[XY]} - \mathbb{E}{[X]} \mathbb{E}{[Y]} = 0\).</p> <p>However, \(X\) and \(Y\) are not <em>necessarily</em> independent. Firstly, we cannot directly conclude that \(Y\) and \(X\) are dependent because \(Y\) is a function of \(X\). We can set \(f(\cdot)\) to be a constant function - which is still an even function. Therefore it is better to construct an example to show that that \(X\) and \(Y\) do not have to be independent. Think about the case when \(X \sim U[-2, 2]\) and \(Y = X^2\). Please observe that this example complies with our construction above. Now, is \(P(Y &gt; 1 \mid -1 &lt; X &lt; 1) = P(Y &gt; 1)?\). The answer is no. \(P(Y &gt; 1 \mid -1 &lt; X &lt; 1) = 0\), but \(P(Y &gt; 1) = \frac{1}{2}\). Therefore, \(X\) and \(Y\) are not independent but can be uncorrelated.</p> <blockquote> <p>Independence requires correlation to be zero. However, (linearly) uncorrelated random variables do not have to be independent.</p> </blockquote> <h2 id="gaussian-distribution">Gaussian Distribution</h2> <p>Now, to focus on the question, let’s remind ourselves univariate and multivariate Gaussian distributions. In the one-dimensional case, a random variable \(X\) is said to have a Gaussian distribution if its probability density function is given by:</p> \[f_X(x) = \frac{1}{\sqrt{2\pi} \sigma} \exp{\left(-\frac{(x - \mu)^2}{2\sigma^2}\right)}\] <p>where \(\mu\) is the mean and \(\sigma\) is the standard deviation of the random variable \(X\). The Gaussian distribution is also known as the normal distribution. Multivariate Gaussian, on the other hand, is a generalization of the univariate Gaussian distribution to higher dimensions. A random vector \(\mathbf{X} = [X_1, X_2, \ldots, X_d]^T\) is said to have a multivariate Gaussian distribution if its probability density function is given by:</p> \[f_{\mathbf{X}}(\mathbf{x}) = \frac{1}{(2\pi)^{d/2} |\Sigma|^{1/2}} \exp{\left(-\frac{1}{2} (\mathbf{x} - \mathbf{\mu})^T \Sigma^{-1} (\mathbf{x} - \mathbf{\mu})\right)}\] <p>where \(\mathbf{\mu} = [\mu_1, \mu_2, \ldots, \mu_d]^T\) is the mean vector, \(\Sigma\) is the covariance matrix, and we use the determinant of it. When the different dimensions of the random vector are uncorrelated, the covariance matrix is diagonal. In this case, we can set \(\Sigma = \text{diag}(\sigma_1^2, \sigma_2^2, \ldots, \sigma_d^2) = \text{diag}(\sigma^2)\). Inverse of a diagonal matrix is again a diagonal matrix with inverse of each entry: \(\Sigma^{-1} = \text{diag}(\frac{1}{\sigma_1^2}, \frac{1}{\sigma_2^2}, \ldots, \frac{1}{\sigma_d^2}) = \text{diag}(\frac{1}{\sigma^2})\). Determinant of a diagonal matrix is the product of its diagonal entries: \(det(\Sigma) = \sigma_1^2 \sigma_2^2 \ldots \sigma_d^2\). We can plug in these values to the multivariate Gaussian distribution to simplify it when the random variables are uncorrelated:</p> \[f_{\mathbf{X}}(\mathbf{x}) = \frac{1}{(2\pi)^{d/2} (\sigma_1^2 \sigma_2^2 \ldots \sigma_d^2)^{d/2}} \exp{\left( -\frac{1}{2} (\mathbf{x} - \mathbf{\mu})^T \text{diag}(\frac{1}{\sigma^2}) (\mathbf{x} - \mathbf{\mu})\right)}\] <p>Now, we can actually decompose this expression into a product of univariate Gaussian distributions. Let’s start with the left part:</p> \[\begin{aligned} \frac{1}{(2\pi)^{d/2} (\sigma_1^2 \sigma_2^2 \ldots \sigma_d^2)^{d/2}} &amp;= \frac{1}{(2\pi)^{d/2} \sigma_1 \sigma_2 \ldots \sigma_d} \\ &amp;= \frac{1}{\sqrt{2\pi} \sigma_1} \frac{1}{\sqrt{2\pi} \sigma_2} \ldots \frac{1}{\sqrt{2\pi} \sigma_d} \\ &amp;= \prod_{i=1}^{d} \frac{1}{\sqrt{2\pi} \sigma_i} \\ \end{aligned}\] <p>Great, let’s not forget that. Now, let’s focus on the exponent part:</p> \[\begin{aligned} (\mathbf{x} - \mathbf{\mu})^T \text{diag}(\frac{1}{\sigma^2}) (\mathbf{x} - \mathbf{\mu}) &amp;= \begin{bmatrix} x_1 - \mu_1 &amp; x_2 - \mu_2 &amp; \ldots &amp; x_d - \mu_d \end{bmatrix} \begin{bmatrix} \frac{1}{\sigma_1^2} &amp; 0 &amp; \ldots &amp; 0 \\ 0 &amp; \frac{1}{\sigma_2^2} &amp; \ldots &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0 &amp; 0 &amp; \ldots &amp; \frac{1}{\sigma_d^2} \end{bmatrix} \begin{bmatrix} x_1 - \mu_1 \\ x_2 - \mu_2 \\ \vdots \\ x_d - \mu_d \end{bmatrix} \\ &amp;= \begin{bmatrix} x_1 - \mu_1 &amp; x_2 - \mu_2 &amp; \ldots &amp; x_d - \mu_d \end{bmatrix} \begin{bmatrix} \frac{x_1 - \mu_1}{\sigma_1^2} \\ \frac{x_2 - \mu_2}{\sigma_2^2} \\ \vdots \\ \frac{x_d - \mu_d}{\sigma_d^2} \end{bmatrix} \\ &amp;= \frac{(x_1 - \mu_1)^2}{\sigma_1^2} + \frac{(x_2 - \mu_2)^2}{\sigma_2^2} + \ldots + \frac{(x_d - \mu_d)^2}{\sigma_d^2} \\ &amp;= \sum_{i=1}^{d} \frac{(x_i - \mu_i)^2}{\sigma_i^2} \\ \end{aligned}\] <p>Inserting our findings back to the equation yields:</p> \[f_{\mathbf{X}}(\mathbf{x}) = \prod_{i=1}^{d} \frac{1}{\sqrt{2\pi} \sigma_i} \exp{\left(-\frac{1}{2}\frac{(x_i - \mu_i)^2}{\sigma_i^2}\right)}\] <p>This is the product of univariate Gaussian distributions. We have shown that when the random variables are uncorrelated, the multivariate Gaussian distribution can be decomposed into a product of univariate Gaussian distributions. But what does it mean? It means that \(f_{\mathbf{X}}(\mathbf{x}) = f_{X_1}(x_1) f_{X_2}(x_2) \ldots f_{X_d}(x_d)\), which implies that the random variables are independent (this is exactly the definition of independence).</p> <blockquote> <p>If two random variables \(X\) and \(Y\) are bivariate normal (jointly normal) and uncorrelated, then they are independent.</p> </blockquote> <h2 id="uncorrelated-normal-random-variables">Uncorrelated Normal Random Variables</h2> <p>Now comes our question: if two normal random variables are uncorrelated, are they necessarily independent? The answer is <strong>no</strong>. We have shown that if two jointly normal random variables are uncorrelated, they are independent. But when we relax the assumption of joint normality, the statement does not hold. Even if two (individually) normally distributed random variables are uncorrelated, they do not have to be independent. Let’s show this with the counterexample from the original post:</p> <p>Say, we have three random variables \(X\), \(Y\) and \(Z\). Let \(X \sim \mathcal{N}(0,\,1)\), \(Z \in \{-1, 1\}\) with equal probabilities and \(Y = Z X\). Now, is \(Y\) normally distributed? Since standard normal distribution is symmetric around zero, \(Y = X\) and \(Y = -X\) are both standard normal random variables. \(Y\) is the sum of standard normal random variables with equal probabilities, which is also a standard normal random variable. Having said that, now let’s calculate the covariance of \(X\) and \(Y\):</p> \[\begin{aligned} \mathrm{Cov}{[X, Y]} &amp;= \mathbb{E}{[XY]} - \mathbb{E}{[X]} \mathbb{E}{[Y]} \\ &amp;= \mathbb{E}{[X^2 Z]} - 0 \cdot 0 \\ &amp;= \mathbb{E}{[X^2 Z]} \\ &amp;= \mathbb{E}{[X^2]} \mathbb{E}{[Z]} \\ &amp;= 1 \cdot 0 \\ &amp;= 0 \end{aligned}\] <p>So we have two (individually) normally distributed and uncorrelated random variables. Are they independent? No! \(P(Y &gt; 0.5 \mid -0.5 &lt; X &lt; 0.5) = 0\), but \(P(Y &gt; 0.5) \neq 0\). Therefore, \(X\) and \(Y\) are not independent but uncorrelated.</p> <blockquote> <p>In summary, it’s important to note that two random variables, each following a normal distribution do not always jointly adhere to a bivariate normal distribution, nor does a covariance of zero imply independence. But when we have a bivariate normal distribution, uncorrelated random variables are independent.</p> </blockquote> <p><strong>References:</strong> Rosenthal, J. S. (2005). Uncorrelated does not imply Independence. Retrieved from <a href="http://probability.ca/jeff/teaching/uncornor.html" target="_blank" rel="noopener noreferrer">http://probability.ca/jeff/teaching/uncornor.html</a></p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Karahan Sarıtaş. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script src="/assets/js/zoom.js"></script> <script src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>